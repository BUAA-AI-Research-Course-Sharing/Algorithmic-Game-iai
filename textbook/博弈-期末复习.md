@GradiusTwinbee
$$
\newcommand{\b}{\boldsymbol}
\newcommand{\d}{\text{d}}
\newcommand{\p}{\partial}
\newcommand{\E}{\mathbb E}
\newcommand{\vp}{\varphi}
$$

# 合作博弈

## 定义

有$n$个玩家构成集合$N$，且玩家$i$有权重$w_i$与个人收益$x_i$，有一个阈值$t$，对任意$S\sub N$，满足
$$
f(S)=\begin{cases}
1&\sum_{i\in S}w_i\geq t\\
0& 其他
\end{cases}\\
\sum_{i\in N}x_i=f(N)
$$
（①$x_i$是针对$N$而言的；②$f(N)=0$就没啥好说的了，所以你也能见到笔记里第二个式子就等于1）

我们称$N$稳定，当且仅当
$$
\forall S\sub N,f(S)\leq \sum_{i\in S}x_i
$$

## 例题

给定阈值$t=7$和权重$\b w$，求使$N$稳定的$\b x$.

（方法：若$S\sub N$能单独成团，则$N-S$中的人的分配为$0$）

(1)$\b w=(6,1,1,1)$

有且只有包含$6$的子集能单飞，于是$\b x=(1,0,0,0)$.

(2)$\b w=(2,2,2,2)$

只有四个人都在才能成团，$\b x$可任取。

(3)$\b w=(3,3,1,1)$

$w_1+w_2+w_3\geq7\Rightarrow x_4=0$

$w_1+w_2+w_4\geq 7\Rightarrow x_3=0$

因此$\b x=(k,1-k,0,0),k\in[0,1]$.

(4)$\b w=(3,3,3,3)$

任意三人均可成团并推出剩下一人分配为$0$，于是$\b x=(0,0,0,0)$，但这与$\sum_{i\in N}x_i=f(N)=1$矛盾，故$N$不可能稳定。

# 单参数机制设计

## 单参数环境

①有$n$个投标人，每个人有一个私有估值$v_i$，出价$b_i$；

②出价向量$\b b=(b_1,b_2,\cdots,b_n)$；

③分配向量$\b x (\b b)= (x_1(\b b ),x_2(\b b ),\cdots,x_n(\b b))$；

④支付向量$\b p(\b b )=(p_1(\b b),p_2(\b b),\cdots,p_n(\b b))$；

⑤第$i$个竞标者的效用函数为$u_i(\b b)=v_ix_i(\b b)-p_i(\b b)$.

## 迈尔森引理

**可实现的分配规则**

对于任何单变量问题，如果存在一个支付规则$\b p$，使得机制$(\b x,\b p)$是诚实的，则分配规则$\b x$是可实现的。

**单调的分配规则**

对于任何单变量问题，如果对于任意$b_{−i}$和$b_i\geq b_i'$，都有$x_i(b_i,b_{−i})\geq x_i(b_i',b_{−i})$，则分配规则$\b x$是单调的。

**迈尔森引理**

对于任何单变量问题，一个分配规则$\b x$是单调的，当且仅当它是可实现的。

**离散形式**
$$
b_1(x(b_2)-x(b_1))\leq p(b_2)-p(b_1)\leq b_2(x(b_2)-x(b_1))
$$
其中$x$是单调递增的，$b_2\geq b_1$.

**连续形式**
$$
p(b_2)-p(b_1)=\int_{b_1}^{b_2} wx'(w)\d w
$$
其中$x$是单调递增的，$b_2\geq b_1$.

## 例题

![image-20220103205157145](博弈-期末复习.assets/image-20220103205157145.png)

①$0\leq b\leq 1$

直接令$p(b)=0$.

②$1<b\leq2$

这段是平的，一整段上的支付都一样，不妨设为$p_{\alpha}$.

由迈尔森引理可得，$\forall b_1\in (0,1),b_2\in(1,2)$，
$$
b_1\alpha\leq p_\alpha\leq b_2\alpha
$$
让$b_1,b_2\rightarrow 1$可得
$$
p_{\alpha}=\alpha
$$
③$2<b\leq3$

由迈尔森引理可得
$$
p(b)-p(2)=\int_{2}^b wx'(w)\d  w
$$
其中
$$
x(w)=(\beta-\alpha)(w-2)+\alpha\qquad 2 \leq w \leq 3\\
x'(w)=\beta-\alpha
$$
所以
$$
p(b)=(\beta-\alpha)\int_2^b w\d w + p(2)=\frac{1}{2}(\beta-\alpha)(b^2-4)+\alpha
$$
④$b>3$

由函数连续性可知此时
$$
p(b)=p(3)=\frac{1}{2}(\beta-\alpha)\times 5 +\alpha = \frac{5}{2}\beta-\frac{3}{2}\alpha
$$

# 拍卖

## 二价拍卖

**单物品二价拍卖**

物品给出价最高者，且支付第二高出价。是诚实的，也最大化社会福利。

**带保留价格的二价拍卖**

增加一个报保留价格的虚拟出价，然后运行单物品二价拍卖。若虚拟出价中标，则物品不卖出。是诚实的。

**k个相同物品二价拍卖**

给出价最高的$k$个人，且支付第$k+1$高出价。是诚实的，也最大化社会福利。

**广义二价拍卖**

背景基于下面的赞助搜索拍卖。

假设$b_1\geq b_2\geq\cdots\geq b_n$，$\b x(\b b)=(\alpha_1,\alpha_2,\cdots,\alpha_k,0,0,\cdots,0)$，则广义二价拍卖给出的支付为
$$
\b p(\b b)=(\alpha_1b_2,\alpha_2b_3,\cdots,\alpha_kb_{k+1},0,0,\cdots,0)
$$
不诚实，但简单直观，易于接受，因而被广泛使用。

## 赞助搜索拍卖

**定义**

①存在$k$个广告位，$n$个竞标人（$n>k$）；

②对第$j$个广告位，其点击率为$\alpha_j$，并且$\alpha_1\geq\alpha_2\geq\cdots\geq\alpha_k$；

③对第$i$个竞标人，如果其对广告效益的估值为$v_i$，赢得了第$j$个广告位并支付$p_i$，那么其效用函数为
$$
u_i=\alpha_jv_i-p_i
$$
**诚实机制**

详细推导可参考第五次笔记（2019级版），此处只给出结论。

假设$b_1\geq b_2\geq\cdots\geq b_n$，定义$\alpha_{k+1}=0$，且令未获得广告位的投标人的支付为$0$.

由迈尔森引理可得以下方程组
$$
p_i-p_{i+1}=b_{i+1}(\alpha_i-\alpha_{i+1})\qquad i=1,\cdots,k
$$
解得
$$
p_i=\sum_{j=i}^k b_{j+1}(\alpha_j-\alpha_{j+1})\qquad i=1,\cdots,k
$$
综上，使机制诚实的支付为
$$
p_i=\begin{cases}
\sum_{j=i}^k b_{j+1}(\alpha_j-\alpha_{j+1})&i\leq k\\
0&其他
\end{cases}
$$

## 背包拍卖

**定义**

有一个容量为$B$的背包和$n$个投标人（物品）。每个投标人有一个权重$w_i$和一个价值$v_i$。$w_i$是公有信息，$v_i$是私有信息。在拍卖中，投标人$i$报价$b_i$。而拍卖方需要根据这些报价，决定哪一拨人可以使用背包，使得这些人的总权重不超过背包的容量$B$的情况下最大化社会福利。

**算法 Ⅰ**

贪心算法，按$\frac{b}{w}$由大到小排序，依次选入直至不能再放下。是诚实的，但可能与最大社会福利相去甚远。

动态规划算法，设$f(i,j)$为只在前$i$个物品中选择且使得总价值为$j$所需的最小权重，则状态转移方程为：
$$
f(i,j)=\min(f(i-1,j),f(i-1,j-v_i)+w_i)
$$
最终得到最大社会福利为$\max_j(f(n,j)\leq B)$.

是精确解，是诚实的，能最大化社会福利，但背包问题是NP难的，其动态规划算法是伪多项式时间算法。

为了降低计算复杂度，可使用动态规划近似算法，用
$$
\bar v_i=\lfloor\frac{nv_i}{\varepsilon\max_j v_j}\rfloor
$$
代替$v_i$，再运行DP算法。该算法是多项式时间的，且是$1-\varepsilon$近似算法，但取整的引入导致分配规则不再单调，无法得到诚实机制。

**动态规划近似算法的不单调例子**

$\varepsilon = 0.99,B=100$

$v_1=v_2=v_3=v_4=v_5=2,v_6=11,v_7=13,v_8=16$

$w_1=w_2=w_3=w_4=w_5=1,w_6=w_7=50,w_8=95$

则round后得
$$
v_1'=v_2'=v_3'=v_4'=v_5'=1,v_6'=5,v_7'=6,v_8'=8
$$
DP给出的选择为$\{1,2,3,4,5,8\}$.

现把$v_8$提高到$17$.

round后得
$$
v_1'=v_2'=v_3'=v_4'=v_5'=0,v_6'=5,v_7'=6,v_8'=8
$$
现在DP给出的选择为$\{6,7\}$.

$8$号提高报价反而被踢出去了，因此不是单调的。

**算法 Ⅱ**

先按$\frac{b_i}{w_i}$从大到小排序，然后搜索满足以下要求的$k$：
$$
\sum_{i=1}^kw_i\leq B \quad\text{and}\quad \sum_{i=1}^{k+1}w_i> B
$$
然后定义两种可行的选法（默认已经把体积比$B$还大的那些物品预先排除了），对应的社会福利如下：
$$
W_1=\sum_{i=1}^k v_i\\
W_2=\max_{i}v_i
$$
我们的算法选择两者中更大的那个，即
$$
W=\max(W_1,W_2)
$$
如果今天我们的背包问题允许物品部分放入背包，对应的最优值为$OOPT$，则显然有
$$
OOPT\leq W_1+v_{k+1}
$$
但我们实际面对的是01背包问题，设其最优值为$OPT $，必有
$$
OPT\leq OOPT
$$
（01背包的可行域是允许物品部分进背包可行域的子集，因此这个不等式一定成立）

于是
$$
OPT\leq W_1+v_{k+1}\leq W_1 + W_2\leq 2W\\
W\geq\frac{1}{2}OPT
$$
即保证至少达到最大社会福利的一半。

对于一个开始没有被选中的投标者而言，提高报价也不会再变更坏了；

对于一个依据$W_1$被选入的投标者而言，那提高报价只会提高他的排名，且之前都能装下他，他提高报价后排名靠前了也肯定能装下，不可能被踢出去；

对于一个依据$W_2$被选入的投标者而言，他已经是所有人中出价最高的了，再提高报价也还是最高的，不会被踢出去。

综上，这个分配规则是单调的，存在支付规则使其变成诚实机制。

# 虚拟估值

## 贝叶斯环境

①单变量环境；

②私有估值$v_i\sim F_i$；

③$F_i$彼此独立，是公开信息；

④$F=\prod_{i=1}^n F_i$.

## 虚拟估值

$v_i$在$F_i$上的虚拟估值为
$$
\varphi_i(v_i)=v_i-\frac{1-F_i(v_i)}{f_i(v_i)}
$$
最大期望收益在形式上等于估价为价值在相应分布上的虚拟估值时的最大期望社会福利，即
$$
\mathbb{E}_{\b v\sim F}\sum_{i=1}^np_i(\b v) = \mathbb{E}_{\b v\sim F}\sum_{i=1}^n\varphi_i(v_i)x_i(\b v)
$$

## 正则分布

如果估值分布$F$所对应的虚拟估值函数$\varphi(v)$是关于$v$非减的，则称$F$是正则的。

$F$正则显然是迈尔森引理的要求。

## 例题

（我们会看到接下来的例子中每个竞标人的估值分布都是相同的，那显然是因为不相同的时候就太难算了。最大化拍卖收益其实就是把原来的估值替换为虚拟估值，再用之前最大化社会福利的方法即可。然而虚拟估值可能为负，但在竞标人估值分布都相同的情况下，我们可以简单地引入保留价格来解决这一问题）。

假设竞标人的估值分布均为正则分布$F$，则虚拟估值$\varphi(v)=v-\frac{1-F(v)}{f(v)}$单调递增.

假设竞标人上报的估价已按从大到小的顺序排为$v_1\geq v_2\geq\cdots\geq v_n$，竞标人的编号也与此对应。

**例1	k个相同物品拍卖**
$$
x_i(\b v)=\begin{cases}
1&\vp(v_i)\geq 0且 i\leq k\\
0&其他
\end{cases}=
\begin{cases}
1&v_i\geq \vp^{-1}(0)且 i\leq k\\
0&其他
\end{cases}
$$

$$
p_i(\b v)=\begin{cases}
\max(v_{k+1},\vp^{-1}(0))&v_i\geq\vp^{-1}(0)且 i\leq k\\
0&其他
\end{cases}
$$

**例2	赞助搜索拍卖**
$$
x_i(\b v)=\begin{cases}
\alpha_i&\vp(v_i)\geq 0且 i\leq k\\
0&其他
\end{cases}=
\begin{cases}
\alpha_i&v_i\geq \vp^{-1}(0)且i\leq k\\
0&其他
\end{cases}
$$
若$\b v$中不小于$\vp^{-1}(0)$的值不少于$k+1$个，则
$$
p_i(\b v)=\begin{cases}
\sum_{j=i}^k v_{j+1}(\alpha_j-\alpha_{j+1})&i\leq k\\
0&其他
\end{cases}
$$
其中$\alpha_{k+1}=0$.

若$\b v$中不小于$\vp^{-1}(0)$的值少于$k+1$个，设只有$m$个不小于$\vp^{-1}(0)$.

令$v_i'=v_i(1\leq i\leq m)$，$v'_{m+1}=\vp^{-1}(0)$，$\alpha'_i=\alpha_i(1\leq i\leq m)$，$\alpha'_{m+1}=0$，则
$$
p_i(\b v)=\begin{cases}
\sum_{j=i}^m v'_{j+1}(\alpha'_j-\alpha'_{j+1})&i\leq m\\
0&其他
\end{cases}
$$
**例3	具体的例子**

两个人的分布都是$[0,1]$上的均匀分布，要拍卖一个物品。那这显然二价拍卖就行了，只是要算下保留价格。
$$
F(v)=v\quad v\in[0,1]
$$
于是
$$
\vp(v)=v-\frac{1-F(v)}{f(v)}=v-(1-v)=2v-1\qquad 
$$
令$\vp(v)=0$得保留价格为$\frac{1}{2}$。

于是运行保留价格为$\frac{1}{2}$的二价拍卖即可使期望收益最大化。

这个最大期望收益能算：

![image-20220104122734223](博弈-期末复习.assets/image-20220104122734223.png)

因此最大期望收益为
$$
2(\frac{1}{2}\times\frac{1}{4}+\int_{\frac{1}{2}}^1\d x\int_\frac{1}{2}^xy\d y)=\frac{5}{12}
$$

# 多参数机制设计

## 多参数环境

①有$n$个投标人；

②有限的结果集合$\Omega$；

③每名投标人$i$的私有估值函数$v_i:\Omega\rightarrow \R$和公开的报价函数$b_i:\Omega\rightarrow \R$；

④分配向量$\b x(\b b)\in\Omega$，支付向量$\b p(\b b )\in\R^n$；

⑤第$i$个竞标者的效用函数为$u_i(\b b)=v_i(x_i(\b b))-p_i(\b b)$.

（与单参数环境的差别在于估值和报价由一个数值变为一个关于分配结果的函数）

## VCG机制

**VCG定理**

在任何一个多参数的机制设计环境下，都存在一个诚实的机制使得社会福利最大化。

**VCG机制**

分配规则
$$
\omega^*=\arg\max_{\omega\in\Omega}\sum_{i=1}^nb_i(\omega)
$$
支付规则
$$
p_i(\b b)=\max_{\omega\in\Omega}\sum_{j\not= i}b_j(\omega)-\sum_{j\not=i}b_j(\omega^*)
$$
（众所周知VCG机制是诚实的，所以你用$\b v$用$\b b$都行）

**VCG的优缺点**

优点：

①当我们想社会福利最大化时，可以从原则上保证机制的诚实性；

②是一个干净的机制。

缺点：

①参数空间可能过大；

②不总是实用的；

③不总能保证卖方有利可图；

④可能存在一些另类的不诚实策略。

**与迈尔森引理的对比**

|          |   迈尔森引理   |       VCG机制        |
| :------: | :------------: | :------------------: |
|   场景   |     单参数     |        多参数        |
| 目标函数 | 任意单调的分配 | 仅仅使社会福利最大化 |
|  实用性  |  通常较为实用  |      实用性较差      |

## 例题

**例1 VCG下的"欺骗"**

三个人拍两个物品A、B。
$$
v_1=\begin{cases}1& 得到AB\\0&其他\end{cases}
\qquad
v_2=\begin{cases}1& 得到A\\0&其他\end{cases}
\qquad
v_3=\begin{cases}1& 得到B\\0&其他\end{cases}
$$
先假设只有1号和2号参与，那一个最佳方案就是AB都给2号，最大社会福利为1.

对于1号而言，最佳方案下其他人收益之和为1，但若1号不参与，则2号还是能够得到A，最大社会福利为1，因此1号的支付为1-1=0.

对于2号而言，最佳方案下其他人收益之和为0，把2号踢出去后，1号能拿到AB，最大社会福利为1，因此2号的支付为1-0=1.

于是拍卖方得到了1.

现在3号也加入拍卖，则最佳方案是A给2号，B给3号，最大社会福利为2.

对于1号而言，它参不参与其他人收益之和都一样，所以1号支付为0.

对于2号而言，其他人收益之和为1，而他不参与时，其他人能达到的最大收益之和还是1，因此2号支付1-1=0.

类似可得3号支付也为0.

于是拍卖方得到0.

本来1、2两个人参与的时候2买到东西还是要付钱的（同时还可能不卖给2，因为AB都给1也是最优方案），但2号去把3号叫来后，2号就可以白嫖A物品了（而且还不担心会被1抢走，因为此时的最优方案唯一；而且3号也得到了想要的B）。可以看出2号一番操作后，拍卖方亏了。

（但这并不意味着我们的VCG不好。时刻记住VCG的目标是最大化社会福利，这时的拍卖方是一个公益性的拍卖方而非盈利性的。公益性拍卖方设置支付只是为了让大家能够诚实报价从而最大化社会福利，而非为了盈利。某种意义上来讲，2号把3号叫来后最大社会福利从1变成了2，这是一个公益性拍卖方所乐于接受的结果，因为它的目标是让社会福利尽可能大）

**例2 路径问题**

![img](file:///C:\Users\123\Documents\Tencent Files\1934878329\Image\C2C\RCRQ652OPFZ4CJ$1X1}UO`O.jpg)

当然要求最短路径啦。为了和VCG的“最大化”相契合，我们把上面的$v$都加上负号吧。

那显然最佳方案就是$v_1v_2v_3$，除了这三条路外的其他路存不存在都不影响最优解，因此其他路的支付都是0.

①

最优解下除开$v_1$外的社会福利之和为-1-5=-6.

假设没有$v_1$，最优解为$v_4v_5v_6$，社会福利为-12.

于是$v_1$支付为$-12-(-6)=-6$，即$v_1$会被支付6.

②

最优解下除开$v_2$外的社会福利之和为-3-5=-8.

假设没有$v_2$，最优解为$v_4v_5v_6$，社会福利为-12.

于是$v_2$支付为$-12-(-8)=-4$，即$v_2$会被支付4.

③

最优解下除开$v_3$外的社会福利之和为-3-1=-4.

假设没有$v_3$，最优解为$v_4v_5v_6$，社会福利为-12.

于是$v_3$支付为$-12-(-4)=-8$，即$v_2$会被支付8.

其实我们已经知道路径问题中，i如果被选入的话，i的支付应该是“i的报价+除开i最短路径长-最短路径长”，于是可以验算：

以上三条路除开各自后最短的都是$v_4v_5v_6$，长度为12，而最短的$v_1v_2v_3$长度为9，于是后面两项的差为3.

$v_1$得到的补偿=3+3=6.

$v_2$得到的补偿=1+3=4.

$v_3$得到的补偿=5+3=8.

与VCG的结果一致。

# 选举

## 社会福利函数

$A$是候选人集合，$L$是$A$上所有全序的集合，有$n$个人投票（每个人都有一个自己的对所有候选人的排序），则社会福利函数为
$$
F:L^n\rightarrow L
$$
（就是说要根据投票结果决定所有候选人的先后顺序）

## 阿罗不可能定理

**帕累托条件（一致性条件）**

若对于任意的投票人$i$，都有$a\prec_i b$，则投票结果中$a\prec b$.

**独立性条件**

对于任意两候选人$a,b$而言，若任意投票人$i$对$a,b$的排序都保持不变，则最终投票结果中$a,b$的排序不变。

**无独裁者**

不存在投票人$i$使得投票结果总等于$i$的排序（$x\prec_i y\Rightarrow x\prec y$）。

**阿罗不可能定理**

当候选人数不少于三人时，若社会福利函数满足一致性条件和独立性条件，则它是独裁的。

（这意味着上面三个条件无法同时成立）

## 社会选择函数

$A$是候选人集合，$L$是$A$上所有全序的集合，有$n$个人投票（每个人都有一个自己的对所有候选人的排序），则社会福利函数为
$$
F:L^n\rightarrow A
$$
（就是说只要选出最厉害的那个人就行了）

## 吉伯德-萨特思韦特不可能定理

**激励相容条件**

记$n$位投票者对候选人的真实排序为$\prec_1,\prec_2,\cdots\prec_n$.

若存在$\prec_i'$使得
$$
F(\prec_i,\prec_{-i})\prec_iF(\prec_i',\prec_{-i})
$$
则称$i$可操纵这次选举。这里的$F$是社会选择函数。

我们称$F$是激励相容的当且仅当任何投票者都不能操纵选举。

**吉伯德-萨特思韦特不可能定理**

当候选人数不少于三人时，若社会选择函数满足一致性条件和激励相容条件，则它是独裁的。

# 无金钱机制设计

## 首位交易环算法（TTCA）

先任意地为所有参与者分配一个房间，构造有向图$G$，所有参与者与其房间的二元组构成顶点集$S$：

①$T\leftarrow S$。

②有向边$e(i,j)$代表当前$j$最喜欢$i$房间。所有有向边的集合为$E$。

③找到一个有向环（必然存在有向环）。

④将环里的房子进行分配。设环为$c1 → c2 → · · · → cn → c1$，则把$c_{i+1}$给$c_i$，并把$c_1$给$c_n$。

⑤将分出去的房子所对应的二元组从$T$中删去。

⑥若$T=\empty$，则终止，否则跳转至②。

TTCA的性质：

①可终止性：算法一定终止。

②弱改进分配：TTCA算法得到的结果一定不比原来差。

③激励相容性：每个人不会谎报自己对房屋的偏好信息。

④核分配：TTCA算法得到的结果中，不存在集合$C ⊂ S$，使得集合$C$中的成员通过彼此交换房间，可以使得每个人的房间都变好。

## 稳定匹配

**不稳定配对**

在一个匹配结果中，对于其中一对$(i,j)$，若与当前匹配的同伴相比，$i$更喜欢$j$，$j$也更喜欢$i$，则称$(i, j)$为一个不稳定配对。

**延迟接受算法（DAA算法，也叫Gale-Shapley算法）**

①若存在某个男生$i$当前没有配对，则找到没有拒绝过$i$的女生中$i$最喜欢的$j$。否则，终止算法。

②若女生$j$当前没有配对，则$(i, j)$配对成功，转到①。否则转③。

③假设女生$j$当前已经配对$v$。若$j$更喜欢$i$，则$(i, j)$配对成功，男生$v$又回到无配对状态；若$j$更喜欢$v$，则$(v, j)$保持，$i$配对失败。转到①。

**延迟算法性质**

①可终止性：算法一定终止。

②返回稳定匹配：算法得到的结果是稳定匹配，即不存在不稳定配对。

③主动方最优：返回的结果对于男生（邀请者）来说是最优的，但对女生（被邀请者）来说是最差的。

④主动方激励相容：对于男生（邀请者）来说是激励相容的，但对于女生（被邀请者）来说不是。

# 纳什均衡

## 占优策略

若参与者$i$的策略$d ∈ S_i$，满足在任何策略局面$s ∈ S_1 × S_2 × · · · × S_n$下，均有$u_i(d,s_{-i})\geq u_i(s_i,s_{-i})$，则称d为占优策略。

## 纯策略纳什均衡

如果对任意的玩家$i$和任意纯策略$s_i'\in S_i$，都有
$$
u_i(s_i,s_{-i})\geq u_i(s_i',s_{-i})
$$
则纯策略局面$s$是纯策略纳什均衡。

最优应对算法用来寻找纯策略纳什均衡——若终止则必然找到一个纯策略纳什均衡；但即使纯策略纳什均衡存在，也可能不终止（找不到）。

## 混合策略纳什均衡

如果对任意的玩家$i$和任意混合策略$p_i'$，都有
$$
\E_{s\sim p}u_i(s_i,s_{-i})\geq\E_{s_i'\sim p_i',s_{-i}\sim p_{-i}}u_i(s_i',s_{-i})
$$
则混合策略局面$p$是混合策略纳什均衡。

任何有限玩家、有限策略的博弈都存在混合策略纳什均衡。

求解混合策略纳什均衡是PPAD类（有向图多项式级奇偶论证类）问题，$P\sub PPAD\sub NP$.

## 例题

|      |  A   |  B   |
| :--: | :--: | :--: |
|  A   | 2，1 | 0，0 |
|  B   | 0，0 | 1，1 |

分析所有的support。左边是1号玩家，上方是2号玩家。

{A}，{A}

没人会改变策略，即$\left(\begin{matrix}1&0\\0&0\end{matrix}\right)$是纳什均衡。

{A}，{B}

都想换策略，不行。

{A}，{A，B}

显然2号玩家还不如一直选A。

{B}，{A}

都想换，不行。

{B}，{B}

都不会换策略，即$\left(\begin{matrix}0&0\\0&1\end{matrix}\right)$是纳什均衡。

{B}，{A，B}

2号玩家还不如一直选B呢。

{A，B}，{A}

1号玩家不如一直选A。

{A，B}，{B}

1号玩家不如一直选B。

{A，B}，{A，B}

假设1号玩家p概率出A，1-p概率出B，目的是让对手不管选其support中的哪一种，期望收益都相同，则
$$
p=1-p\Rightarrow p=\frac{1}{2}
$$
所以玩家1以一半概率玩A，一半概率玩B。

假设2号玩家p概率出A，1-p概率出B，目的是让对手不管选其support中的哪一种，期望收益都相同，则
$$
2p=1-p\Rightarrow p=\frac{1}{3}
$$
所以玩家2以$\frac{1}{3}$概率玩A，$\frac{2}{3}$概率玩B。

此时得到的纳什均衡为$\left(\begin{matrix}\frac{1}{6}&\frac{1}{3}\\\frac{1}{6}&\frac{1}{3}\end{matrix}\right)$.

# 势博弈

## 势博弈

如果存在函数$f:S\rightarrow\R$使得对任意玩家$i$，对任意策略局面$s\in S$和任意策略$s_i'\in S_i$，有
$$
u_i(s)-u_i(s_i',s_{-i})=f(s)-f(s_i',s_{-i})
$$
则该博弈是势博弈。

（$f$和$u$的区别在于$u$是每个玩家私有的而$f$是公共的）

势博弈一定有纯策略纳什均衡。

有纯策略纳什均衡不一定是势博弈。

## 拥塞博弈

（也没有很清晰的定义，一种常见的网络模型参考无秩序代价中的例题）

拥塞博弈是势博弈。

对任意势博弈而言，都存在一个与之势函数相同的拥塞博弈。

## 例题

假设我们的博弈长这样

|      |  A   |  B   |
| :--: | :--: | :--: |
|  A   | 2，1 | 0，0 |
|  B   | 0，0 | 1，2 |

设我们的势函数为

|      |  A   |  B   |
| :--: | :--: | :--: |
|  A   |  a   |  b   |
|  B   |  c   |  d   |

1号玩家从A策略变到B策略可得
$$
c-a=-2,d-b=1
$$
2号玩家从A策略变到B策略可得
$$
b-a=-1,d-c=2
$$
解得（并不唯一）
$$
a=2,b=1,c=0,d=2
$$
即求得一个势函数。

# 相关均衡

## 各种均衡间的关系

![image-20220104105217916](博弈-期末复习.assets/image-20220104105217916.png)

## 相关均衡

$\sigma$是$\prod_{i=1}^n S_i$上的分布。如果对任意玩家$i$和任意策略$s_i,s_i'\in S_i$，都有
$$
\E_{s\sim\sigma}(u_i(s)|s_i)\geq\E_{s\sim\sigma}(u_i(s_i',s_{-i})|s_i)
$$
则$\sigma$是相关均衡。

## 粗相关均衡

$\sigma$是$\prod_{i=1}^n S_i$上的分布。如果对任意玩家$i$和任意策略$s_i'\in S_i$，都有
$$
\E_{s\sim\sigma}(u_i(s))\geq\E_{s\sim\sigma}(u_i(s_i',s_{-i}))
$$
则$\sigma$是粗相关均衡。

（相关均衡中，玩家是会被上帝告知说你该选哪个策略的，玩家依据此可以缩小概率空间，比如说二人表格博弈中知道自己在哪行在哪列——但即使知道了更多信息，玩家也要愿意听从指挥。而粗相关均衡中玩家不会获得更多信息。所以说相关均衡比粗相关均衡更“难”，是粗相关均衡的子集）

## 例题

|      |  A   |  B   |
| :--: | :--: | :--: |
|  A   | 2，1 | 0，0 |
|  B   | 0，0 | 1，1 |

假设联合概率分布如下

|      |  A   |  B   |
| :--: | :--: | :--: |
|  A   |  a   |  b   |
|  B   |  c   |  d   |

（注意，当你告诉玩家选哪个的时候，本质上告诉了他我们处在哪个概率空间）

当告诉玩家1选A时，他不会改成B
$$
2a\geq b
$$
当告诉玩家1选B时，他不会改成A
$$
d\geq 2c
$$
当告诉玩家2选A时，他不会改成B
$$
a\geq c
$$
当告诉玩家2选B时，他不会改成A
$$
d\geq b
$$
概率非负
$$
a,b,c,d\geq0
$$
概率之和为$1$
$$
a+b+c+d=1
$$
显然，可行解有很多，比如
$$
\left(\begin{matrix}\frac{2}{3}&0\\0&\frac{1}{3}\end{matrix}\right)
$$

# 无秩序代价

## 定义

$$
PoA=\frac{最坏均衡下的社会代价}{最优解下的社会代价}
$$

## 例题

**例1**

![image-20220104001549795](博弈-期末复习.assets/image-20220104001549795.png)

设有$a$单位一直走上面，有$b$单位选择先走上面再绕到下面，有$c$单位选择一直走下面。

（显然起点到终点就这三种走法。以及，我应该说清楚了是怎么走的了吧......）

先考察各种support，看它们能不能形成均衡。

{a}

那走下面会更快啊，不行。

{b}

那显然一直走上面会更快，不行。

{c}

那就一直走上面，不行。

{a,b}

此时走a的代价是2，那走c的代价小于2.

{a,c}

a,c两条路要相等那肯定一边走一半，但此时走b会代价更小，不行。

{b,c}

走c是2但走啊a小于2，不行。

{a,b,c}

这个时候三条路径都选入了，不存在和未选入路径比较的事情了，只要三条路径相等就好了。

于是
$$
\begin{cases}
a+b+1=a+b+2b+b+c=1+b+c\\
a+b+c=1
\end{cases}
$$
解得
$$
a=\frac{2}{5},b=\frac{1}{5},c=\frac{2}{5}
$$
社会代价为
$$
1\times(a+b+1)=\frac{8}{5}
$$
下求解最优解，即求解
$$
\min\quad a(a+b+1)+b(a+4b+c)+c(b+c+1)\\
\text{s.t.}\quad a+b+c=1
$$
稍作整理即可得
$$
\min \quad3b^2+b+2(a+c)-2ac\\
\text{s.t.} \quad a+b+c = 1
$$
用拉格朗日乘子法求解
$$
L=\quad3b^2+b+2(a+c)-2ac+\lambda(a+b+c-1)\\
\begin{cases}
\frac{\p L}{\p a}=2-2c+\lambda=0\\
\frac{\p L}{\p b}=6b+1+\lambda=0\\
\frac{\p L}{\p c}=2-2a+\lambda=0\\
\frac{\p L}{\p \lambda}= a+b+c-1=0
\end{cases}
\Rightarrow
\begin{cases}
\lambda=-1\\
a=\frac{1}{2}\\
b=0\\
c=\frac{1}{2}
\end{cases}
$$
此时社会代价为
$$
3b^2+b+2(a+c)-2ac=2-2\times\frac{1}{4}=\frac{3}{2}
$$
因此无秩序代价为
$$
PoA=\frac{\frac{8}{5}}{\frac{3}{2}}=\frac{16}{15}
$$
**例2**

再举一个课上的例子，到终点只有两条路，一条是1（设为a），一条是x（设为b），总共有1个单位的流量。

{a}

那肯定走b更快，不行。

{b}

走a也不会变得更好，因此是均衡。

{a,b}

走b的代价小于1，而a的是1，不可能均衡。

于是唯一的均衡是大家都走b，社会代价为1.

下求解最优解，
$$
\min \quad a +b^2\\
\text{s.t.}\quad a+b=1
$$
换元嘛，就可以解得最优解为
$$
a=\frac{1}{2},b=\frac{1}{2}
$$
社会代价为
$$
a +b^2=\frac{3}{4}
$$
因此无秩序代价为
$$
PoA=\frac{1}{\frac{3}{4}}=\frac{4}{3}
$$

# 扩展式博弈

## 完美信息扩展式博弈

象棋、围棋、跳棋等，玩家知道对局全部信息，因此能确定自己所处的状态。

理论上一定能用极大极小算法求得均衡和最佳对弈策略。

## 不完美信息扩展式博弈

斗地主、麻将等，有的信息是私有的，玩家只能知道自己处在某个状态集合中，而不知道具体是该集合中的哪个状态。